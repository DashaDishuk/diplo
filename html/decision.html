<!DOCTYPE html>
<html lang="en">
<head>
    <title>Decision</title>
    <link rel="stylesheet" href="../style.css">
        <script type="text/javascript">
        let criterions = new Array();

        function criterionsEnter() {
            var criterionsAmount= parseInt(document.getElementById("criterionsAmount").value, 10);
            alert(criterionsAmount);
            
            //create buttons for criterias. to choose what kind are they
            for (i=0;i<criterionsAmount;i++){
                criterions[i]=new Map();
                criterions[i].set("name",prompt("name","somename"));
                
                var newDiv = document.createElement("div");
                var str=criterions[i].get("name");
                newDiv.innerHTML ='<h1>'+str+'</h1>';
                newDiv.setAttribute('id','div'+str);
                document.body.appendChild(newDiv);

                var newButtonL = document.createElement("input");
                newButtonL.setAttribute('type','button');
                newButtonL.setAttribute('id','funcChoosing'+str);
                newButtonL.setAttribute('value','Functional '+str+' criterion');
                newButtonL.setAttribute('onClick','funcСriterionsChoosing("'+str+'",'+i+')');

                var newButtonR = document.createElement("input");
                newButtonR.setAttribute('type','button');
                newButtonR.setAttribute('id','tablChoosing'+str);
                newButtonR.setAttribute('value','Table '+str+' criterion');
                newButtonR.setAttribute('onClick','tablСriterionsChoosing("'+str+'",'+i+')');
                
                var newButtonC = document.createElement("input");
                newButtonC.setAttribute('type','button');
                newButtonC.setAttribute('id','simpChoosing'+str);
                newButtonC.setAttribute('value','Simple '+str+' criterion');
                newButtonC.setAttribute('onClick','simpСriterionsChoosing("'+str+'",'+i+')');

                var newForm=document.createElement("form");
                newForm.setAttribute('id','form'+str);
                newForm.appendChild(newButtonL);
                newForm.appendChild(newButtonR);
                newForm.appendChild(newButtonC);
                document.body.appendChild(newForm);
                }

            var newButtonA = document.createElement("input");
            newButtonA.setAttribute('type','button');
            newButtonA.setAttribute('id','alts');
            newButtonA.setAttribute('value','Enter alts');
            newButtonA.setAttribute('onClick','altern('+i+')');            
            document.body.appendChild(newButtonA);

            return new_criterionsAmount;
            }

            //DONE choosing kind of functions
            function funcСriterionsChoosing(str,i){
                criterions[i].set("criterionType","func");

                var newDivO = document.createElement("div");
                newDivO.innerHTML='<img src="../img/one.jpg"><br>';
                newDivO.setAttribute("id","funcO"+str);
                newButtonO = document.createElement("input");
                newButtonO.setAttribute('type','button');
                newButtonO.setAttribute('value','Func one-side '+str+' criterion');
                newButtonO.setAttribute('onClick','funcСriterionsCreationO("'+str+'",'+i+')');
                newDivO.appendChild(newButtonO);

                var newDivT = document.createElement("div");
                newDivT.innerHTML='<img src="../img/three.jpg"><br>';
                newDivT.setAttribute("id","funcT"+str);
                newButtonT = document.createElement("input");
                newButtonT.setAttribute('type','button');
                newButtonT.setAttribute('value','Func both-side '+str+' criterion');
                newButtonT.setAttribute('onClick','funcСriterionsCreationT("'+str+'",'+i+')');
                newDivT.appendChild(newButtonT);
                                
                document.getElementById("funcChoosing"+str).replaceWith(newDivO);
                document.getElementById("tablChoosing"+str).replaceWith(newDivT);
                document.getElementById("simpChoosing"+str).remove();
            }
            
            //DONE filling data for one-side function criterias
            function funcСriterionsCreationO(str, i){                
                criterions[i].set("criterionType","funcO");
                var newDiv = document.createElement("div");
                newDiv.innerHTML='<img src="../img/onefill.jpg"><br>';
                newDiv.setAttribute("id","funcFilling"+str);

                innerHtmlText='<input type="text" id="'+str+'x0" value="1">';
                innerHtmlText+='<input type="text" id="'+str+'x1" value="1">';
                newDiv.innerHTML+=innerHtmlText;

                newButtonT = document.createElement("input");
                newButtonT.setAttribute('type','button');
                newButtonT.setAttribute('value','Save');
                newButtonT.setAttribute('onClick','funcСriterionsSaveO("'+str+'",'+i+')');
                newDiv.appendChild(newButtonT);
            
                document.getElementById("funcO"+str).replaceWith(newDiv);
                document.getElementById("funcT"+str).remove();
            }

            //DONE filling data for both-side function criterias
            function funcСriterionsCreationT(str, i){                
                criterions[i].set("criterionType","funcO");
                var newDiv = document.createElement("div");
                newDiv.innerHTML='<img src="../img/threefill.jpg"><br>';
                newDiv.setAttribute("id","funcFilling"+str);

                innerHtmlText='<input type="text" id="'+str+'x0" value="1">';
                innerHtmlText+='<input type="text" id="'+str+'x1" value="1">';
                innerHtmlText+='<input type="text" id="'+str+'x2" value="1">';
                innerHtmlText+='<input type="text" id="'+str+'x3" value="1">';
                newDiv.innerHTML+=innerHtmlText;

                newButtonT = document.createElement("input");
                newButtonT.setAttribute('type','button');
                newButtonT.setAttribute('value','Save');
                newButtonT.setAttribute('onClick','funcСriterionsSaveT("'+str+'",'+i+')');
                newDiv.appendChild(newButtonT);
              
                document.getElementById("funcO"+str).replaceWith(newDiv);
                document.getElementById("funcT"+str).remove();

            }

            //DONE saving data for one-side functions
            function funcСriterionsSaveO(str,i){
                let x=new Array(2);
                for (k=0;k<x.length;k++){
                    x[k]=parseFloat(document.getElementById(str+"x"+k).value);
                }
                criterions[i].set("funcValues",x);
                document.getElementById("div"+str).remove();
                document.getElementById("form"+str).remove();
            }

            //DONE saving data for both-side functions
            function funcСriterionsSaveT(str,i){
                let x=new Array(4);
                for (k=0;k<x.length;k++){
                    x[k]=parseFloat(document.getElementById(str+"x"+k).value);
                }
                criterions[i].set("funcValues",x);
                document.getElementById("div"+str).remove();
                document.getElementById("form"+str).remove();
            }

            //DONE creates field for amount and button to submin for criterias as tables
            function tablСriterionsChoosing(str,i){
                criterions[i].set("criterionType","table");

                var newDiv=document.createElement("input");
                newDiv.setAttribute('type','text');
                newDiv.setAttribute('id','paramsAmountFor'+str);
                newDiv.setAttribute('value','0');
                
                var newButton = document.createElement("input");
                newButton.setAttribute('type','button');
                newButton.setAttribute('id','tabl'+str);
                newButton.setAttribute('value','Table amount'+str+' criterion');
                newButton.setAttribute('onClick','tablСriterionsCreation("'+str+'",'+i+')');
                                
                document.getElementById("form"+str).prepend(newDiv);
                document.getElementById("funcChoosing"+str).replaceWith(newButton);
                document.getElementById("tablChoosing"+str).remove();
                document.getElementById("simpChoosing"+str).remove();
            }

            //DONE create table for entering params
            function tablСriterionsCreation(str,i) {
                var paramsAmount=parseInt(document.getElementById("paramsAmountFor"+str).value, 10);
                var innerHtmlText='';
                for (k=0;k<paramsAmount+1;k++){
                    innerHtmlText+='<div>';
                    for (j=0;j<paramsAmount;j++){
                       innerHtmlText+='<input type="text" id="'+str+k+j+'" value="1">';
                    }
                    innerHtmlText+='</div>';
                }
           
                var newButtonR = document.createElement("input");
                newButtonR.setAttribute('type','button');
                newButtonR.setAttribute('id','tablSaving'+str);
                newButtonR.setAttribute('value','Table '+str+' criterion save');
                newButtonR.setAttribute('onClick','tablСriterionsSave("'+str+'",'+i+','+paramsAmount+')');
 
                var newForm=document.createElement("form");
                newForm.setAttribute('id',str+"form");
                newForm.innerHTML=innerHtmlText;
                document.getElementById("paramsAmountFor"+str).replaceWith(newForm);
                document.getElementById("tabl"+str).replaceWith(newButtonR);

            }

            //DONE saving users data from tables 
            function tablСriterionsSave(str,i,j){
                let temp=new Array(j);
                let names=new Array(j);
                for (k=0;k<j;k++){
                    temp[k]=[];
                    names[k]=document.getElementById(str+0+k).value;
                    for (q=1;q<j+1;q++){
                        temp[k][q-1]=parseInt(document.getElementById(str+q+k).value, 10);
                    }
                }
                criterions[i].set("paramValues",temp);
                criterions[i].set("paramnames",names);

                document.getElementById("div"+str).remove();
                document.getElementById(str+"form").remove();
                document.getElementById('tablSaving'+str).remove();

            }

            //DONE simple criterias
            function simpСriterionsChoosing(str,i){                
                criterions[i].set("criterionType","simpl");

                var newDiv=document.createElement("input");
                newDiv.setAttribute('type','text');
                newDiv.setAttribute('id','paramsAmountFor'+str);
                newDiv.setAttribute('value','0');
                
                var newButton = document.createElement("input");
                newButton.setAttribute('type','button');
                newButton.setAttribute('id','simp'+str);
                newButton.setAttribute('value','Create');
                newButton.setAttribute('onClick','simpСriterionsCreation("'+str+'",'+i+')');
                                
                document.getElementById("form"+str).prepend(newDiv);
                document.getElementById("funcChoosing"+str).replaceWith(newButton);
                document.getElementById("tablChoosing"+str).remove();
                document.getElementById("simpChoosing"+str).remove();
            }

            //DONE fields for filling simple
            function simpСriterionsCreation(str,i){
                var paramsAmount=parseInt(document.getElementById("paramsAmountFor"+str).value, 10);
                var innerHtmlText='';
                for (j=0;j<paramsAmount;j++){
                    innerHtmlText+='<div>';
                    innerHtmlText+='<input type="text" id="'+str+'Val'+j+'" value="value">';
                    innerHtmlText+='<input type="text" id="'+str+'Name'+j+'" value="name">';
                    innerHtmlText+='</div>';
                }
           
                var newButtonR = document.createElement("input");
                newButtonR.setAttribute('type','button');
                newButtonR.setAttribute('id','simpSaving'+str);
                newButtonR.setAttribute('value','Save');
                newButtonR.setAttribute('onClick','simpСriterionsSave("'+str+'",'+i+','+paramsAmount+')');
 
                var newForm=document.createElement("form");
                newForm.setAttribute('id',str+"form");
                newForm.innerHTML=innerHtmlText;
                document.getElementById("paramsAmountFor"+str).replaceWith(newForm);
                document.getElementById("simp"+str).replaceWith(newButtonR);
            }

            function simpСriterionsSave(str,i,j){
                alert("p am = "+j);
                let values=new Array(j);
                let names=new Array(j);
                for (k=0;k<j;k++){
                    values[k]=document.getElementById(str+"Val"+k).value;;
                    names[k]=document.getElementById(str+"Name"+k).value;
                }

                criterions[i].set("paramValues",values);
                criterions[i].set("paramnames",names);

                document.getElementById("div"+str).remove();
                document.getElementById("form"+str).remove();
                document.getElementById('simpSaving'+str).remove();
            }

            //TODO entering alts
            function altern(i){
                alert(i);
            }

        </script>
        <style>
        </style>
    </head>
    <body><center>
    <form name="form" id="criterionsForm">
        <label>Количество критериев:</label>
    <input type="text" id="criterionsAmount" value="0" />
    <input type="button" value="show" onClick="criterionsEnter()">
    </form>
</center>    
</body>
</html>